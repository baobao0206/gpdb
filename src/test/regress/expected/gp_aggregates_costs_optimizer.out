set statement_mem="1800";
create table cost_agg_t1(a int, b int, c int);
insert into cost_agg_t1 select i, random() * 99999, i % 2000 from generate_series(1, 1000000) i;
create table cost_agg_t2 as select * from cost_agg_t1 with no data;
insert into cost_agg_t2 select i, random() * 99999, i % 300000 from generate_series(1, 1000000) i;
explain select avg(b) from cost_agg_t1 group by c;
                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice2; segments: 3)  (cost=0.00..485.40 rows=2000 width=8)
   ->  Result  (cost=0.00..485.34 rows=667 width=8)
         ->  HashAggregate  (cost=0.00..485.34 rows=667 width=8)
               Group Key: c
               ->  Redistribute Motion 3:3  (slice1; segments: 3)  (cost=0.00..485.26 rows=667 width=12)
                     Hash Key: c
                     ->  Result  (cost=0.00..485.23 rows=667 width=12)
                           ->  HashAggregate  (cost=0.00..485.23 rows=667 width=12)
                                 Group Key: c
                                 ->  Seq Scan on cost_agg_t1  (cost=0.00..438.70 rows=333334 width=8)
 Optimizer: Pivotal Optimizer (GPORCA) version 3.62.0
(11 rows)

explain select avg(b) from cost_agg_t2 group by c;
                                                 QUERY PLAN                                                 
------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice2; segments: 3)  (cost=0.00..510.83 rows=300306 width=8)
   ->  Result  (cost=0.00..501.88 rows=100102 width=8)
         ->  HashAggregate  (cost=0.00..501.88 rows=100102 width=8)
               Group Key: c
               ->  Redistribute Motion 3:3  (slice1; segments: 3)  (cost=0.00..489.33 rows=100102 width=12)
                     Hash Key: c
                     ->  Result  (cost=0.00..485.57 rows=100102 width=12)
                           ->  HashAggregate  (cost=0.00..485.57 rows=100102 width=12)
                                 Group Key: c
                                 ->  Seq Scan on cost_agg_t2  (cost=0.00..438.70 rows=333334 width=8)
 Optimizer: Pivotal Optimizer (GPORCA) version 3.62.0
(11 rows)

insert into cost_agg_t2 select i, random() * 99999,1 from generate_series(1, 200000) i;
analyze cost_agg_t2;
explain select avg(b) from cost_agg_t2 group by c;
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice2; segments: 3)  (cost=0.00..505.08 rows=105614 width=8)
   ->  Result  (cost=0.00..501.93 rows=35205 width=8)
         ->  HashAggregate  (cost=0.00..501.93 rows=35205 width=8)
               Group Key: c
               ->  Redistribute Motion 3:3  (slice1; segments: 3)  (cost=0.00..497.52 rows=35205 width=12)
                     Hash Key: c
                     ->  Result  (cost=0.00..496.19 rows=35205 width=12)
                           ->  HashAggregate  (cost=0.00..496.19 rows=35205 width=12)
                                 Group Key: c
                                 ->  Seq Scan on cost_agg_t2  (cost=0.00..440.24 rows=400000 width=8)
 Optimizer: Pivotal Optimizer (GPORCA) version 3.62.0
(11 rows)

set statement_mem = '125MB';
